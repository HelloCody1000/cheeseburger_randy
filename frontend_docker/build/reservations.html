<script>
    // Set today's date as the default for the date input
    const dateInput = document.getElementById("date");
    const today = new Date().toISOString().split("T")[0];
    dateInput.setAttribute("min", today); // Disallow past dates
    dateInput.value = today;

    // Populate hours and minutes dropdowns
    const hourSelect = document.getElementById("hour");
    const minuteSelect = document.getElementById("minute");

    // Hours from 11 AM to 9 PM (12-hour format)
    const hours = [11, 12, 1, 2, 3, 4, 5, 6, 7, 8, 9];
    hours.forEach(hour => {
        const option = document.createElement("option");
        option.value = hour;
        option.textContent = hour;
        hourSelect.appendChild(option);
    });

    // Minutes in 15-minute increments
    const minutes = ["00", "15", "30", "45"];
    minutes.forEach(min => {
        const option = document.createElement("option");
        option.value = min;
        option.textContent = min;
        minuteSelect.appendChild(option);
    });

    document.getElementById('reservationForm').addEventListener('submit', function(event) {
        event.preventDefault();  // Prevent the default form submission

        // Get date in YYYYMMDD format
        const reservationDate = document.getElementById("date").value.replace(/-/g, '');

        // Get the hour, minute, and period (AM/PM)
        let hour = parseInt(hourSelect.value);
        const minute = minuteSelect.value;
        const period = document.getElementById("period").value;

        // Convert to military time format if PM
        if (period === "PM" && hour !== 12) {
            hour += 12;
        } else if (period === "AM" && hour === 12) {
            hour = 0;
        }
        // Format hour to always be two digits
        const militaryHour = hour.toString().padStart(2, '0');

        // Combine date and military time to form the reservation ID prefix
        const reservationDateTime = `${reservationDate}${militaryHour}${minute}`; // Example: 202410311300 for 1:00 PM

        const reservationData = {
            name: document.getElementById('name').value,
            phone: document.getElementById('phone').value,
            email: document.getElementById('email').value,
            time: reservationDateTime // Pass the combined date and time as a single value
        };

        // Sending the data to the REST API (replace the URL below with your API Gateway URL)
        fetch('https://5n81fcqxt6.execute-api.us-east-1.amazonaws.com/dev/reservations', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(reservationData)
        })
        .then(response => response.json())
        .then(data => {
            document.getElementById('responseMessage').innerText = "Reservation successful!";
        })
        .catch(error => {
            document.getElementById('responseMessage').innerText = "Error making reservation. Please try again.";
            console.error('Error:', error);
        });
    });
</script>
